my.doc.cor
for (i in 1:length.doc) {
for (j in 1:length.doc) {
my.doc.cor[i,j] <- my.assoc.func(t(dtm.e),rownames(dtm.e)[i],rownames(dtm.e)[j])$est
}
}
#?ê?ê³„ìˆ˜ ?‰ë ¬???¼ë?ë§??´í´ë³´ì.
round(my.doc.cor)
#?ˆë? ?¤ì–´ ì²«ë²ˆì§?ë¬¸ì„œ, ì¦?p2009a.txt???¤ë¥¸ ë¬¸ì„œ?¤ê³¼ ?´ë–¤ ?ê?ê´€ê³„ë? ê°–ëŠ”ì§€ ?´í´ë³????ˆë‹¤.
round(my.doc.cor[,1],2)
summary(my.doc.cor[lower.tri(my.doc.cor)])
#?„ë˜?€ ê°™ì? ë°©ë²•?¼ë¡œ ë¬¸ì„œê°??ê?ê³„ìˆ˜???ˆìŠ¤? ê·¸?¨ì„ ?´í´ë³´ì.
hist(my.doc.cor[lower.tri(my.doc.cor)],breaks=30,
col='lightblue',xlim=c(0.0 ,0.9),xlab="correlations",
main="Correlations between each chapter of bibles")
install.packages("corrplot")
library(corrplot)
plot(my.doc.cor)
round(my.doc.cor)
plot(my.doc.cor)
corrplot(my.doc.cor, method = "circle")
rownames(my.doc.cor) <- colnames(my.doc.cor) <- rownames(dtm.e)
round(my.doc.cor)
corrplot(my.doc.cor, method = "circle")
dist.dtm.e <- dist(dtm.e)
myclusters <- hclust(dist.dtm.e,method="ward.D2")
plot(myclusters)
myclusters$labels <- str_extract(myclusters$labels, "[[:digit:]]{4}[[:alpha:]]{1}")
#êµ°ì§‘ë¶„ì„ê²°ê³¼ë¥?ê·¸ë˜?„ë¡œ ê·¸ë¦¬ë©??„ë˜?€ ê°™ë‹¤.
plot(myclusters)
myclusters <- hclust(dist.dtm.e,method="ward.D2")
plot(myclusters1)
plot(myclusters1)
dist.dtm.e <- dist(dtm.e)
myclusters <- hclust(dist.dtm.e,method="ward.D2")
plot(myclusters1)
plot(my.doc.cor)
corrplot(my.doc.cor, method = "circle")
dist.dtm.e <- dist(dtm.e)
myclusters1 <- hclust(dist.dtm.e,method="ward.D2")
plot(myclusters1)
myclusters$labels2 <- str_extract(myclusters$labels, "[[:digit:]]{4}")
#êµ°ì§‘ë¶„ì„ê²°ê³¼ë¥?ê·¸ë˜?„ë¡œ ê·¸ë¦¬ë©??„ë˜?€ ê°™ë‹¤.
plot(myclusters2)
myclusters2$labels <- str_extract(myclusters$labels, "[[:digit:]]{4}")
#êµ°ì§‘ë¶„ì„ê²°ê³¼ë¥?ê·¸ë˜?„ë¡œ ê·¸ë¦¬ë©??„ë˜?€ ê°™ë‹¤.
plot(myclusters2)
plot(myclusters)
myclusters$labels <- str_extract(myclusters$labels, "[[:digit:]]{4}")
#êµ°ì§‘ë¶„ì„ê²°ê³¼ë¥?ê·¸ë˜?„ë¡œ ê·¸ë¦¬ë©??„ë˜?€ ê°™ë‹¤.
plot(myclusters)
myclusters$labels <- str_extract(myclusters$labels, "[[:digit:]]{4}[[:alpha:]]{1}")
#êµ°ì§‘ë¶„ì„ê²°ê³¼ë¥?ê·¸ë˜?„ë¡œ ê·¸ë¦¬ë©??„ë˜?€ ê°™ë‹¤.
plot(myclusters)
myclusters$labels <- str_extract(myclusters$labels, "[[:alpha:]]{1}")
#êµ°ì§‘ë¶„ì„ê²°ê³¼ë¥?ê·¸ë˜?„ë¡œ ê·¸ë¦¬ë©??„ë˜?€ ê°™ë‹¤.
plot(myclusters)
myclusters1 <- hclust(dist.dtm.e,method="ward.D2")
plot(myclusters)
myclusters$labels <- str_extract(myclusters$labels, "[[:alpha:]]{1}")
dist.dtm.e <- dist(dtm.e)
myclusters1 <- hclust(dist.dtm.e,method="ward.D2")
plot(myclusters)
dist.dtm.e <- dist(dtm.e)
myclusters1 <- hclust(dist.dtm.e,method="ward.D2")
plot(myclusters)
library('dendextend')
install.packages("dendextend")
library('dendextend')
plot(my.doc.cor)
corrplot(my.doc.cor, method = "circle")
dist.dtm.e <- dist(dtm.e)
myclusters1 <- hclust(dist.dtm.e,method="ward.D2")
plot(myclusters)
rownames(my.doc.cor) <- colnames(my.doc.cor) <- rownames(dtm.e)
#?ê?ê³„ìˆ˜ ?‰ë ¬???¼ë?ë§??´í´ë³´ì.
round(my.doc.cor)
options(max.print = .Machine$integer.max)
round(my.doc.cor)
#?ˆë? ?¤ì–´ ì²«ë²ˆì§?ë¬¸ì„œ???¤ë¥¸ ë¬¸ì„œ?¤ê³¼ ?´ë–¤ ?ê?ê´€ê³„ë? ê°–ëŠ”ì§€ ?´í´ë³????ˆë‹¤.
round(my.doc.cor[,1],2)
#?„ë˜?€ ê°™ì? ë°©ë²•?¼ë¡œ ë¬¸ì„œê°??ê?ê³„ìˆ˜???ˆìŠ¤? ê·¸?¨ì„ ?´í´ë³´ì.
hist(my.doc.cor[lower.tri(my.doc.cor)],breaks=30,
col='lightblue',xlim=c(0.0 ,0.9),xlab="correlations",
main="Correlations between each chapter of bibles")
summary(my.doc.cor[lower.tri(my.doc.cor)])
#?„ì˜ ?ê?ê³„ìˆ˜ ?‰ë ¬???´ìš©??EFA??PCAë¥??¤ì‹œ?˜ëŠ” ê²ƒë„ ê°€?¥í•˜??
factanal(factors=5,covmat=my.doc.cor,rotation="promax")
plot(my.doc.cor)
corrplot(my.doc.cor, method = "circle")
dist.dtm.e <- dist(dtm.e)
myclusters1 <- hclust(dist.dtm.e,method="ward.D2")
plot(myclusters)
dist.dtm.e <- dist(dtm.e)
myclusters <- hclust(dist.dtm.e,method="ward.D2")
plot(myclusters)
mygroup <- cutree(myclusters,k=5)
mygroup
table(mygroup)
dend <- as.dendrogram(myclusters)
myk <- 5
dend <- dend %>%
color_branches(k = myk) %>%
color_labels(dend, k=myk) %>%
set("branches_lwd", 2) %>%
set("branches_lty", 1)
plot(dend,main="Clustering documents",ylab="Height",
ylim=c(0,30))
myk <- 8
dend <- dend %>%
color_branches(k = myk) %>%
color_labels(dend, k=myk) %>%
set("branches_lwd", 2) %>%
set("branches_lty", 1)
plot(dend,main="Clustering documents",ylab="Height",
ylim=c(0,30))
mygroup <- cutree(myclusters,k=8)
mygroup
table(mygroup)
dend <- as.dendrogram(myclusters)
myk <- 8
dend <- dend %>%
color_branches(k = myk) %>%
color_labels(dend, k=myk) %>%
set("branches_lwd", 2) %>%
set("branches_lty", 1)
plot(dend,main="Clustering documents",ylab="Height",
ylim=c(0,30))
dend <- dend %>%
color_branches(k = myk) %>%
color_labels(dend, k=myk) %>%
set("branches_lwd", 2) %>%
set("branches_lty", 1)
plot(dend,main="Clustering documents",ylab="Height",
ylim=c(0,150))
plot(dend,main="Clustering documents",ylab="Height",
ylim=c(0,500))
plot(dend,main="Clustering documents",ylab="Height",
ylim=c(0,1500))
#8ê°œì˜ êµ°ì§‘???¤ì •?˜ê³ , ê°?êµ°ì§‘ë³„ë¡œ ì¶œê°„?„ë„??ë¹ˆë„ë¥?êµ¬í•´ë³´ì
mytable <- table(str_extract(myclusters$labels,"[[:digit:]]*"),
+                  cutree(myclusters,k=8))
mytable
q()
#ë¼ì´ë¸ŒëŸ¬ë¦¬ êµ¬ë™
library('stringr')
library('tm')
library('RWeka')
library('devtools')
library('ggpubr')
library('ngram')
library('quanteda')
library('FSelector')
my.text.location <- "AllBible/"
mybible  <- VCorpus(DirSource(my.text.location))
#ë§ë­‰ì¹˜ë¥¼ ê²€í† í•´ ë´…ì‹œë‹¤
mybible
summary(mybible)
#ë§ë­‰ì¹˜ë¥¼ êµ¬ì„±í•˜ëŠ” ë‘ ë²ˆì§¸ ë¬¸ì„œëŠ”?
mybible[[2]]
#ë§ë­‰ì¹˜ë¥¼ êµ¬ì„±í•˜ëŠ” ë‘ ë²ˆì§¸ ë¬¸ì„œì˜ ë‚´ìš©ì€?
mybible[[2]]$content
#ë§ë­‰ì¹˜ë¥¼ êµ¬ì„±í•˜ëŠ” ë‘ ë²ˆì§¸ ë¬¸ì„œì˜ ë©”íƒ€ë°ì´í„°ëŠ”?
mybible[[2]]$meta
#ë©”íƒ€ë°ì´í„° ì…ë ¥
meta(mybible[[2]],tag='author') <- 'Moses'
meta(mybible[[2]])
#ë‹¤ìŒê³¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ íŠ¹ìˆ˜ê¸°í˜¸ ì‚¬ìš© ì „í›„ì˜ ë‹¨ì–´ë“¤ì´ ë¬´ì—‡ì¸ì§€ ì‚´í´ë³¼ ìˆ˜ ìˆë‹¤.
myfunc <- function(x) {str_extract_all(x,"[[:alnum:]]{1,}[[:punct:]]{1}?[[:alnum:]]{1,}")}
mypuncts <- lapply(mybible, myfunc)
table(unlist(mypuncts))
#ë‹¤ìŒê³¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ìˆ˜ì¹˜ë¡œ í‘œì‹œëœ ìë£Œê°€ ì–´ë–¤ ê²ƒì¸ì§€ ì‚´í´ë³¼ ìˆ˜ ìˆë‹¤.
myfunc <- function(x) {str_extract_all(x,"[[:digit:]]{1,}")}
mydigits <- lapply(mybible, myfunc)
table(unlist(mydigits))
length(table(unlist(mydigits)))
#ë‹¤ìŒê³¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ëŒ€ë¬¸ìë¡œ ì‹œì‘í•˜ëŠ” ë‹¨ì–´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤(ê³ ìœ ëª…ì‚¬ í™•ì¸ì— ìœ ìš©í•¨)
myfunc <- function(x) {str_extract_all(x,"[[:upper:]]{1}[[:alpha:]]{1,}")}
myuppers <- lapply(mybible, myfunc)
table(unlist(myuppers))
#ìš°ì„  ìˆ«ìí‘œí˜„ë“¤ì„ ëª¨ë‘ ì‚­ì œí•˜ì˜€ë‹¤.
mycorpus <- tm_map(mybible, removeNumbers)
#ë‹¤ìŒìœ¼ë¡œ íŠ¹ìˆ˜ë¬¸ìê°€ ë“¤ì–´ê°„ í‘œí˜„ë“¤ ì¤‘ í•˜ë‚˜ì˜ ë‹¨ì–´ë¡œ ì·¨ê¸‰ë˜ì–´ì•¼ í•˜ëŠ” ê²ƒë“¤ì„ ì²˜ë¦¬í•˜ì˜€ë‹¤.
#removePunctuationì˜ ê²½ìš° í…ìŠ¤íŠ¸ ì„±ê²©ì„ ê³ ë ¤í•œ ì•„ë˜ì˜ ì‚¬í•­ë“¤ì„ ë°˜ì˜í•˜ì§€ ëª»í•œë‹¤.
mytempfunc <- function(myobject,oldexp,newexp){
newobject <- tm_map(myobject,
content_transformer(function(x, pattern) gsub(pattern, newexp, x)), oldexp)
newobject
}
mycorpus <- mytempfunc(mycorpus,"-collar","collar")
mycorpus <- mytempfunc(mycorpus,"\\b((c|C)o-)","co")
mycorpus <- mytempfunc(mycorpus,"\\b((c|C)ross-)","cross")
mycorpus <- mytempfunc(mycorpus,"e\\.g\\.","for example")
mycorpus <- mytempfunc(mycorpus,"i\\.e\\.","that is")
mycorpus <- mytempfunc(mycorpus,"\\'s","")
mycorpus <- mytempfunc(mycorpus,"sâ€™","s")
mycorpus <- mytempfunc(mycorpus,"ICD-","ICD")
mycorpus <- mytempfunc(mycorpus,"\\b((i|I)nter-)","inter")
mycorpus <- mytempfunc(mycorpus,"K-pop","Kpop")
mycorpus <- mytempfunc(mycorpus,"\\b((m|M)eta-)","meta")
mycorpus <- mytempfunc(mycorpus,"\\b((o|O)pt-)","opt")
mycorpus <- mytempfunc(mycorpus,"\\b((p|P)ost-)","post")
mycorpus <- mytempfunc(mycorpus,"-end","end")
mycorpus <- mytempfunc(mycorpus,"\\b((w|W)ithin-)","within")
mycorpus <- mytempfunc(mycorpus,"=","is equal to")
mycorpus <- mytempfunc(mycorpus,"and/or","and or")
mycorpus <- mytempfunc(mycorpus,"his/her","his her")
mycorpus <- mytempfunc(mycorpus,"-"," ")
#ë‚˜ë¨¸ì§€ íŠ¹ìˆ˜ë¬¸ìë“¤ì€ ê³µë€ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì œê±°í•˜ì˜€ë‹¤.
#removePunctuationì˜ ê²½ìš° and/oRì„ and orë¡œ ë°”ê¾¸ì§€ ì•Šê³ , andorë¡œ ë°”ê¾¸ëŠ” ë“± ì—¬ê¸°ì„œëŠ” ë¬¸ì œê°€ ì ì§€ ì•Šë‹¤.
mycorpus <- tm_map(mycorpus, removePunctuation)
#ê³µë€ì²˜ë¦¬ê³¼ì •
mycorpus <- tm_map(mycorpus, stripWhitespace)
#ëŒ€ì†Œë¬¸ìë¥¼ í†µí•©í•˜ì˜€ë‹¤.
mycorpus <- tm_map(mycorpus, content_transformer(tolower))
#ë¶ˆìš©ë‹¨ì–´ë“¤ ì‚­ì œ(SMART ëª©ë¡ ì‚¬ìš©)
mycorpus <- tm_map(mycorpus, removeWords, words=stopwords("SMART"))
#ìŠ¤í…Œë°(ì–´ê·¼ë™ì¼í™”) ì²˜ë¦¬í•˜ì˜€ë‹¤.
mycorpus <- tm_map(mycorpus, stemDocument, language="en")
#ìš°ì„  ë¬¸ììˆ˜ì™€ ë‹¨ì–´ìˆ˜ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•œ ê°œì¸ë§ì¶¤í˜• í•¨ìˆ˜ ì„¤ì •
mycharfunc <- function(x) {str_extract_all(x,".")}
mywordfunc <- function(x) {str_extract_all(x,boundary("word"))}
#ì‚¬ì „ì²˜ë¦¬ê³¼ì • ì ìš©ì´ì „
mychar <- lapply(mybible, mycharfunc)
myuniquechar0 <- length(table(unlist(mychar)))
mytotalchar0 <- sum(table(unlist(mychar)))
myword <- lapply(mybible, mywordfunc)
myuniqueword0 <- length(table(unlist(myword)))
mytotalword0 <- sum(table(unlist(myword)))
#ì‚¬ì „ì²˜ë¦¬ê³¼ì • ì ìš©ì´í›„
mychar <- lapply(mycorpus, mycharfunc)
myuniquechar1 <- length(table(unlist(mychar)))
mytotalchar1 <- sum(table(unlist(mychar)))
myword <- lapply(mycorpus, mywordfunc)
myuniqueword1 <- length(table(unlist(myword)))
mytotalword1 <- sum(table(unlist(myword)))
#ì‚¬ì „ì²˜ë¦¬ë¡œ ì¸í•´ ì–´ë–»ê²Œ ë³€í™”í–ˆëŠ”ì§€ë¥¼ ì‚´í´ë³´ì.
results.comparing <- rbind(
c(myuniquechar0,myuniquechar1),
c(mytotalchar0,mytotalchar1),
c(myuniqueword0,myuniqueword1),
c(mytotalword0,mytotalword1))
colnames(results.comparing) <- c("before","after")
rownames(results.comparing) <- c("ê³ ìœ ë¬¸ììˆ˜","ì´ë¬¸ììˆ˜","ê³ ìœ ë‹¨ì–´ìˆ˜","ì´ë‹¨ì–´ìˆ˜")
results.comparing
#ì´ì œ ë¬¸ì„œXë‹¨ì–´í–‰ë ¬ì„ êµ¬ì¶•í•˜ì.
#TermDocumentMatrixë¥¼ ì‚¬ìš©í•˜ë©´ ê°€ë¡œì¤„ì—ëŠ” ë‹¨ì–´ê°€, ì„¸ë¡œì¤„ì—ëŠ” ë¬¸ì„œê°€ ë°°ì¹˜ëœë‹¤.
dtm.e <- DocumentTermMatrix(mycorpus)
dtm.e
#í–‰ë ¬ì‹ìœ¼ë¡œ í‘œí˜„
rownames(dtm.e[,])
colnames(dtm.e[,])
#í–‰ë ¬ì˜ ì¼ë¶€ë§Œ ì‚´í´ë³´ê³  ì‹¶ë‹¤ë©´
inspect(dtm.e[1:3,50:55])
#ê³µë€ì²˜ë¦¬(stripping white space) ê³¼ì •
mytext <- c("software environment","software  environment","software\tenvironment")
mytext
#ë‹¨ì–´ë¥¼ ' 'ìœ¼ë¡œ êµ¬ë¶„í•´ë³´ì.
str_split(mytext,' ')
#ê° ì˜¤ë¸Œì íŠ¸ë³„ ë‹¨ì–´ìˆ˜ì™€ ë¬¸ììˆ˜ë¥¼ ì„¸ë³´ì.
sapply(str_split(mytext, " "),length)
sapply(str_split(mytext, " "),str_length)
#ê³µë€ì²˜ë¦¬ê³¼ì •ì„ ê±°ì¹œ í›„ì— ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ì‚´í´ë³´ì.
mytext.nowhitespace <- str_replace_all(mytext,"[[:space:]]{1,}"," ")
mytext.nowhitespace
#ê° ì˜¤ë¸Œì íŠ¸ë³„ ë‹¨ì–´ìˆ˜ì™€ ë¬¸ììˆ˜ë¥¼ ì„¸ë³´ì.
sapply(str_split(mytext.nowhitespace,' '),length)
sapply(str_split(mytext.nowhitespace,' '),str_length)
#ëŒ€ì†Œë¬¸ì í†µì¼ê³¼ì •
mytext <- "The 45th President of the United States, Donald Trump, states that he knows how to play trump with the former president"
myword <- unlist(str_extract_all(mytext,boundary("word")))
table(myword)
#Trump ì™€ Statesê°€ ê³ ìœ ëª…ì‚¬ì„ì´ ë“œëŸ¬ë‚˜ê²Œ _unique_í‘œí˜„ì„ ë§ë¶™ì˜€ë‹¤.
myword <- str_replace(myword,"Trump","Trump_unique_")
myword <- str_replace(myword,"States","States_unique_")
#ëŒ€ë¬¸ìë¥¼ ì†Œë¬¸ìë¡œ ì „í™˜í•œ í›„ ë¹ˆë„í‘œë¥¼ ë„ì¶œí–ˆë‹¤.
table(tolower(myword))
mytext <- c("He is one of statisticians agreeing that R is the No. 1 statistical software.","He is one of statisticians agreeing that R is the No. one statistical software.")
str_split(mytext," ")
#ìˆ«ììë£Œë¥¼ ì œê±°í•˜ëŠ” ë°©ë²•
mytext2 <- str_split(str_replace_all(mytext,"[[:digit:]]{1,}[[:space:]]{1,}","")," ")
str_c(mytext2[[1]],collapse=" ")
str_c(mytext2[[2]],collapse=" ")
#ìˆ«ììë£Œì„ì„ í‘œì‹œí•˜ê³  ìˆ˜ì¹˜ì˜ êµ¬ì²´ì ì¸ ë‚´ìš©ì€ ê³ ë ¤í•˜ì§€ ì•ŠëŠ” ë°©ë²•
mytext3 <- str_split(str_replace_all(mytext,"[[:digit:]]{1,}[[:space:]]{1,}","_number_ ")," ")
str_c(mytext3[[1]],collapse=" ")
str_c(mytext3[[2]],collapse=" ")
mytext <- "Baek et al. (2014) argued that the state of default-setting is critical for people to protect their own personal privacy on the Internet."
#ì‚¬ë¡€ë¡œ ë“  ë¬¸ì¥ì—ì„œ al.ì˜ .ëŠ” ë¬¸ì¥êµ¬ë¶„ í‘œì‹œê°€ ì•„ë‹ˆë‹¤.
str_split(mytext,"\\. ")
#ë‹¨ì–´ë“¤ì„ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.
str_split(mytext," ")
#default-settingì„ ë‘ ë‹¨ì–´ë¡œ? ì•„ë‹ˆë©´ í•œë‹¨ì–´ë¡œ? ê°œì¸ì ìœ¼ë¡œ 2ë‹¨ì–´ê°€ ë§ë‹¤ê³  ë´„.
#"ì„± ë‹¤ìŒì˜ et al. (ë…„ë„)"ì˜ í˜•ì‹ì„ ë¨ ê²½ìš° í•˜ë‚˜ì˜ ë‹¨ì–´ë¡œ êµì²´.
#ë‹¨ì–´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¶„ì„í•˜ê¸° ë•Œë¬¸ì—, ë§ˆì¹¨í‘œëŠ” ì—†ì–´ë„ ë  ë“¯.
mytext2 <- str_replace_all(mytext,"-"," ")
mytext2 <- str_replace_all(mytext2,"[[:upper:]]{1}[[:alpha:]]{1,}[[:space:]](et al\\.)[[:space:]]\\([[:digit:]]{4}\\)","_reference_")
mytext2 <- str_replace_all(mytext2,"\\.[[:space:]]{0,}","")
mytext2
mytext <- c("She is an actor","She is the actor")
#ë‹¤ìŒê³¼ ê°™ì´ ë¶ˆìš©ë‹¨ì–´ë“¤ì˜ ëª©ë¡ì„ ì˜¤ë¸Œì íŠ¸ë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ë©´ í¸í•˜ë‹¤
mystopwords <- "(\\ba )|(\\ban )|(\\bthe )"
str_replace_all(mytext,mystopwords,"")
#tm ë¼ì´ë¸ŒëŸ¬ë¦¬ì— í¬í•¨ëœ ì˜ì–´ ë¶ˆìš©ë‹¨ì–´ ëª©ë¡ë“¤ì€ ë‘ ê°€ì§€ë‹¤.
library('tm')
#ì§§ì€ ë¶ˆìš©ë‹¨ì–´ ëª©ë¡ë“¤ì—ëŠ” ì´ 174ê°œì˜ ë‹¨ì–´ë“¤ì´ í¬í•¨ë˜ì–´ ìˆë‹¤.
length(stopwords("en"))
#ê¸´ ë¶ˆìš©ë‹¨ì–´ ëª©ë¡ë“¤ì—ëŠ” ì´ 571ê°œì˜ ë‹¨ì–´ë“¤ì´ í¬í•¨ë˜ì–´ ìˆë‹¤.
length(stopwords("SMART"))
#length() í•¨ìˆ˜í‘œí˜„ì„ ì—†ì• ë©´ ì–´ë–¤ ë‹¨ì–´ë“¤ì´ ë¶ˆìš©ë‹¨ì–´ ëª©ë¡ì— í¬í•¨ë˜ì—ˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.
stopwords("en")
stopwords("SMART")
#ë‹¤ìŒê³¼ ê°™ì€ ì•½ì‹ ì–´ê·¼ë™ì¼í™” í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ì–´ ë³´ì.
mystemmer.func <- function(mytextobject,mystemmer,mystemmed){
mytext <- str_replace_all(mytext,
"(\\bam )|(\\bare )|(\\bis )|(\\bwas )|(\\bwere )|(\\bbe )","be ")
mytext
}
#ì˜ˆì‹œ í…ìŠ¤íŠ¸ ë°ì´í„°
mytext <- c("I am a boy. You are a boy. He might be a boy.")
mytext.stem <- mystemmer.func(mytext)
#ì–´ê·¼ ë™ì¼í™”ì´ì „ê³¼ ì´í›„ì˜ í…ìŠ¤íŠ¸ ë°ì´í„°ì˜ ë‹¨ì–´ë“¤ì´ ì–´ë–»ê²Œ ë‹¤ë¥¸ ë¹ˆë„í‘œë¥¼ ê°–ê³  ìˆëŠ”ì§€ ì‚´í´ë³´ì.
table(str_split(mytext," "))
table(str_split(mytext.stem," "))
#ì•„ë˜ì˜ í…ìŠ¤íŠ¸ ë°ì´í„°ì—ì„œëŠ” the/The, United, Statesê°€ 3íšŒ ê°™ì€ ìˆœì„œë¡œ ì œì‹œë˜ê³  ìˆë‹¤.
mytext <- "The United States comprises fifty states. In the United States, each state has its own laws. However, federal law overrides state law in the United States."
myword <- unlist(str_extract_all(mytext,boundary("word")))
length(table(myword))
sum(table(myword))
#United, Statesë¥¼ ë¶™ì–´ìˆëŠ” ë‹¨ì–´, ì¦‰ 2-gram, í˜¹ì€ bigramì´ë¼ê³  ê°€ì •í•˜ì.
mytext.2gram <- str_replace_all(mytext,"\\bUnited States","United_States")
myword2 <- unlist(str_extract_all(mytext.2gram,boundary("word")))
length(table(myword2))
sum(table(myword2))
#the/The. United, Statesë¥¼ ë¶™ì–´ìˆëŠ” ë‹¨ì–´, ì¦‰ 3-gram, í˜¹ì€ trigramì´ë¼ê³  ê°€ì •í•˜ì.
mytext.3gram <- str_replace_all(mytext,"\\b(t|T)he United States","The_United_States")
myword3 <- unlist(str_extract_all(mytext.3gram,boundary("word")))
length(table(myword3))
sum(table(myword3))
#tm ë¼ì´ë¸ŒëŸ¬ë¦¬ êµ¬ë™
library('tm')
#ëª¨ì•„ë†“ì€ í…ìŠ¤íŠ¸ ìë£Œì˜ í™”ì¼ ìœ„ì¹˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
#2009ë…„ë¶€í„° 2015ë…„ê¹Œì§€ ë°±ì˜ë¯¼ì˜ ì¶œê°„ë…¼ë¬¸ ì´ˆë¡ì˜ ë§ë­‰ì¹˜ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.
my.text.location <- "D:/data/ymbaek_papers"
mypaper  <- VCorpus(DirSource(my.text.location))
#ë§ë­‰ì¹˜ë¥¼ ê²€í† í•´ ë´…ì‹œë‹¤
mypaper
summary(mypaper)
#ë§ë­‰ì¹˜ë¥¼ êµ¬ì„±í•˜ëŠ” ë‘ ë²ˆì§¸ ë¬¸ì„œëŠ”?
mypaper[[2]]
#ë§ë­‰ì¹˜ë¥¼ êµ¬ì„±í•˜ëŠ” ë‘ ë²ˆì§¸ ë¬¸ì„œì˜ ë‚´ìš©ì€?
mypaper[[2]]$content
#ë§ë­‰ì¹˜ë¥¼ êµ¬ì„±í•˜ëŠ” ë‘ ë²ˆì§¸ ë¬¸ì„œì˜ ë©”íƒ€ë°ì´í„°ëŠ”?
mypaper[[2]]$meta
#ë©”íƒ€ë°ì´í„° ì…ë ¥
meta(mypaper[[2]],tag='author') <- 'Y. M. Baek'
meta(mypaper[[2]])
#ë‹¤ìŒê³¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ íŠ¹ìˆ˜ê¸°í˜¸ ì‚¬ìš© ì „í›„ì˜ ë‹¨ì–´ë“¤ì´ ë¬´ì—‡ì¸ì§€ ì‚´í´ë³¼ ìˆ˜ ìˆë‹¤.
myfunc <- function(x) {str_extract_all(x,"[[:alnum:]]{1,}[[:punct:]]{1}?[[:alnum:]]{1,}")}
mypuncts <- lapply(mypaper, myfunc)
table(unlist(mypuncts))
#ë‹¤ìŒê³¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ìˆ˜ì¹˜ë¡œ í‘œì‹œëœ ìë£Œê°€ ì–´ë–¤ ê²ƒì¸ì§€ ì‚´í´ë³¼ ìˆ˜ ìˆë‹¤.
myfunc <- function(x) {str_extract_all(x,"[[:digit:]]{1,}")}
mydigits <- lapply(mypaper, myfunc)
table(unlist(mydigits))
#ë‹¤ìŒê³¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ëŒ€ë¬¸ìë¡œ ì‹œì‘í•˜ëŠ” ë‹¨ì–´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤(ê³ ìœ ëª…ì‚¬ í™•ì¸ì— ìœ ìš©í•¨)
myfunc <- function(x) {str_extract_all(x,"[[:upper:]]{1}[[:alpha:]]{1,}")}
myuppers <- lapply(mypaper, myfunc)
table(unlist(myuppers))
#ìš°ì„  ìˆ«ìí‘œí˜„ë“¤ì„ ëª¨ë‘ ì‚­ì œí•˜ì˜€ë‹¤.
mycorpus <- tm_map(mypaper, removeNumbers)
#ë‹¤ìŒìœ¼ë¡œ íŠ¹ìˆ˜ë¬¸ìê°€ ë“¤ì–´ê°„ í‘œí˜„ë“¤ ì¤‘ í•˜ë‚˜ì˜ ë‹¨ì–´ë¡œ ì·¨ê¸‰ë˜ì–´ì•¼ í•˜ëŠ” ê²ƒë“¤ì„ ì²˜ë¦¬í•˜ì˜€ë‹¤.
#removePunctuationì˜ ê²½ìš° í…ìŠ¤íŠ¸ ì„±ê²©ì„ ê³ ë ¤í•œ ì•„ë˜ì˜ ì‚¬í•­ë“¤ì„ ë°˜ì˜í•˜ì§€ ëª»í•œë‹¤.
mytempfunc <- function(myobject,oldexp,newexp){
newobject <- tm_map(myobject,
content_transformer(function(x, pattern) gsub(pattern, newexp, x)), oldexp)
newobject
}
mycorpus <- mytempfunc(mycorpus,"-collar","collar")
mycorpus <- mytempfunc(mycorpus,"\\b((c|C)o-)","co")
mycorpus <- mytempfunc(mycorpus,"\\b((c|C)ross-)","cross")
mycorpus <- mytempfunc(mycorpus,"e\\.g\\.","for example")
mycorpus <- mytempfunc(mycorpus,"i\\.e\\.","that is")
mycorpus <- mytempfunc(mycorpus,"\\'s","")
mycorpus <- mytempfunc(mycorpus,"sâ€™","s")
mycorpus <- mytempfunc(mycorpus,"ICD-","ICD")
mycorpus <- mytempfunc(mycorpus,"\\b((i|I)nter-)","inter")
mycorpus <- mytempfunc(mycorpus,"K-pop","Kpop")
mycorpus <- mytempfunc(mycorpus,"\\b((m|M)eta-)","meta")
mycorpus <- mytempfunc(mycorpus,"\\b((o|O)pt-)","opt")
mycorpus <- mytempfunc(mycorpus,"\\b((p|P)ost-)","post")
mycorpus <- mytempfunc(mycorpus,"-end","end")
mycorpus <- mytempfunc(mycorpus,"\\b((w|W)ithin-)","within")
mycorpus <- mytempfunc(mycorpus,"=","is equal to")
mycorpus <- mytempfunc(mycorpus,"and/or","and or")
mycorpus <- mytempfunc(mycorpus,"his/her","his her")
mycorpus <- mytempfunc(mycorpus,"-"," ")
#ë‚˜ë¨¸ì§€ íŠ¹ìˆ˜ë¬¸ìë“¤ì€ ê³µë€ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì œê±°í•˜ì˜€ë‹¤.
#removePunctuationì˜ ê²½ìš° and/oRì„ and orë¡œ ë°”ê¾¸ì§€ ì•Šê³ , andorë¡œ ë°”ê¾¸ëŠ” ë“± ì—¬ê¸°ì„œëŠ” ë¬¸ì œê°€ ì ì§€ ì•Šë‹¤.
mycorpus <- tm_map(mycorpus, removePunctuation)
#ê³µë€ì²˜ë¦¬ê³¼ì •
mycorpus <- tm_map(mycorpus, stripWhitespace)
#ëŒ€ì†Œë¬¸ìë¥¼ í†µí•©í•˜ì˜€ë‹¤.
mycorpus <- tm_map(mycorpus, content_transformer(tolower))
#ë¶ˆìš©ë‹¨ì–´ë“¤ ì‚­ì œ(SMART ëª©ë¡ ì‚¬ìš©)
mycorpus <- tm_map(mycorpus, removeWords, words=stopwords("SMART"))
#ìŠ¤í…Œë°(ì–´ê·¼ë™ì¼í™”) ì²˜ë¦¬í•˜ì˜€ë‹¤.
mycorpus <- tm_map(mycorpus, stemDocument, language="en")
#ìš°ì„  ë¬¸ììˆ˜ì™€ ë‹¨ì–´ìˆ˜ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•œ ê°œì¸ë§ì¶¤í˜• í•¨ìˆ˜ ì„¤ì •
mycharfunc <- function(x) {str_extract_all(x,".")}
mywordfunc <- function(x) {str_extract_all(x,boundary("word"))}
#ì‚¬ì „ì²˜ë¦¬ê³¼ì • ì ìš©ì´ì „
mychar <- lapply(mypaper, mycharfunc)
myuniquechar0 <- length(table(unlist(mychar)))
mytotalchar0 <- sum(table(unlist(mychar)))
myword <- lapply(mypaper, mywordfunc)
myuniqueword0 <- length(table(unlist(myword)))
mytotalword0 <- sum(table(unlist(myword)))
#ì‚¬ì „ì²˜ë¦¬ê³¼ì • ì ìš©ì´í›„
mychar <- lapply(mycorpus, mycharfunc)
myuniquechar1 <- length(table(unlist(mychar)))
mytotalchar1 <- sum(table(unlist(mychar)))
myword <- lapply(mycorpus, mywordfunc)
myuniqueword1 <- length(table(unlist(myword)))
mytotalword1 <- sum(table(unlist(myword)))
#ì‚¬ì „ì²˜ë¦¬ë¡œ ì¸í•´ ì–´ë–»ê²Œ ë³€í™”í–ˆëŠ”ì§€ë¥¼ ì‚´í´ë³´ì.
results.comparing <- rbind(
c(myuniquechar0,myuniquechar1),
c(mytotalchar0,mytotalchar1),
c(myuniqueword0,myuniqueword1),
c(mytotalword0,mytotalword1))
colnames(results.comparing) <- c("before","after")
rownames(results.comparing) <- c("ê³ ìœ ë¬¸ììˆ˜","ì´ë¬¸ììˆ˜","ê³ ìœ ë‹¨ì–´ìˆ˜","ì´ë‹¨ì–´ìˆ˜")
results.comparing
#ì´ì œ ë¬¸ì„œXë‹¨ì–´í–‰ë ¬ì„ êµ¬ì¶•í•˜ì.
#TermDocumentMatrixë¥¼ ì‚¬ìš©í•˜ë©´ ê°€ë¡œì¤„ì—ëŠ” ë‹¨ì–´ê°€, ì„¸ë¡œì¤„ì—ëŠ” ë¬¸ì„œê°€ ë°°ì¹˜ëœë‹¤.
dtm.e <- DocumentTermMatrix(mycorpus)
dtm.e
#í–‰ë ¬ì‹ìœ¼ë¡œ í‘œí˜„
rownames(dtm.e[,])
colnames(dtm.e[,])
#ì—”ê·¸ë¨ ë„ì¶œê³¼ì •
library('RWeka')
bigramTokenizer <- function(x) NGramTokenizer(x, Weka_control(min=2, max=3))
#ì•ì—ì„œ ì‚¬ìš©í•œ The United States ì‚¬ë¡€ë¥¼ ì‚´í´ë³´ì.
mytext <- c(mycorpus)
mytemp <- VCorpus(VectorSource(mytext))
ngram.tdm <- TermDocumentMatrix(mytemp, control=list(tokenize=bigramTokenizer))
bigramlist <- apply(ngram.tdm[,],1,sum)
#ë¹ˆë„ìˆ˜ê°€ ë†’ì€ ë°”ì´ê·¸ë¨ë¶€í„° ì‚´í´ë³´ì.
sort(bigramlist,decreasing=TRUE)
install.packages("xlsx")
install.packages("rJava")
install.packages("rJava")
require(rJava)
install.packages("rJava")
install.packages("rJava")
#ë¹ˆë„ìˆ˜ê°€ ë†’ì€ ë°”ì´ê·¸ë¨ë¶€í„° ì‚´í´ë³´ì.
sort(bigramlist,decreasing=TRUE)
#ë¹ˆë„ìˆ˜ê°€ ë†’ì€ ë°”ì´ê·¸ë¨ë¶€í„° ì‚´í´ë³´ì.
bigram <- sort(bigramlist,decreasing=TRUE)
capture.output(bigram,
file = "C:/Users/rkm14/Documents/bigram.txt",
append = TRUE)
setwd("D:/Workspace/R_Statistics/ch03")
install.packages("prob")
pbinom(1, size = n4, prob = (1-p4))
n4 <- 20
p4 <- 1/5
x4 <- 0:n4
pbinom(1, size = n4, prob = (1-p4))
px4 <- dbinom(x4, size = n4, prob = (1-p4))
plot(x4, px4, type="s", xlab="íšŒë³µë¥ (x)", ylab="í™•ë¥ ", main="íšŒë³µë¥  ë¶„í¬(í™•ë¥ 1/5)")
pbinom(1, size = n4, prob = (1-p4))
plot(x4, px4, type="s", xlab="íšŒë³µë¥ (x)", ylab="í™•ë¥ ", main="íšŒë³µë¥  ë¶„í¬(í™•ë¥ 1/5)")
px4 <- dbinom(x4, size = n4, prob = p4)
plot(x4, px4, type="s", xlab="íšŒë³µë¥ (x)", ylab="í™•ë¥ ", main="íšŒë³µë¥  ë¶„í¬(í™•ë¥ 1/5)")
pbinom(2, size = n4, prob = (1-p4))
plot(x4, px4, type="s", xlab="íšŒë³µë¥ (x)", ylab="í™•ë¥ ", main="íšŒë³µë¥  ë¶„í¬(í™•ë¥ 1/5)")
pbinom(20, size = n4, prob = (1-p4))
pbinom(18, size = n4, prob = (1-p4))
plot(x4, px4, type="s", xlab="íšŒë³µë¥ (x)", ylab="í™•ë¥ ", main="íšŒë³µë¥  ë¶„í¬(í™•ë¥ 1/5)")
pbinom(18, size = n4, prob = (1-p4))
pbinom(19, size = n4, prob = (1-p4))
qnorm(0.713,mean = mu1, sd=sigma1)
mu1 <- 11
sigma1 <- 16
ll1 <- mu1 - 3*sigma1
ul1 <- mu1 + 3*sigma1
x02 <- seq(ll1, ul1, by=0.01)
nd02 <- dnorm(x02, mean = mu1,sd = sigma1)
plot(x02 , nd02, type="l", xlab= "x",ylab="p(X=x)", lwd=2,col="red")
qnorm(0.713,mean = mu1, sd=sigma1)
qnorm(0.713,mean = mu1, sd=sigma1)
pnorm(0.713,mean = mu1, sd=sigma1)
x02 <- seq(ll1, ul1, by=0.01)
nd02 <- dnorm(x02, mean = mu1,sd = sigma1)
plot(x02 , nd02, type="l", xlab= "x",ylab="p(X=x)", lwd=2,col="red")
qnorm(20,mean = mu1,sd=sigma)
qnorm(20,mean = mu1,sd=sigma1)
dnorm(20,mean = mu1,sd=sigma1)
plot(x02 , nd02, type="l", xlab= "x",ylab="p(X=x)", lwd=2,col="red")
mu1 <- 11
sigma1 <- 16
ll1 <- mu1 - 3*sigma1
ul1 <- mu1 + 3*sigma1
x02 <- seq(ll1, ul1, by=0.01)
nd02 <- dnorm(x02, mean = mu1,sd = sigma1)
plot(x02 , nd02, type="l", xlab= "x",ylab="p(X=x)", lwd=2,col="red")
dnorm(20,mean = mu1,sd=sigma1)
pnorm(20,mean = mu1,sd=sigma1,lower.tail = FALSE)
qnorm(0.90,mean = mu1, sd=sigma1) #31.5ë…„
